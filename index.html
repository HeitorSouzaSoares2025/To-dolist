<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neon To-Do List</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body.dark{background:#000;color:#0ff}
.task-card.dragging{opacity:.5}
.calendar input[type="date"]{background:#111;color:#0ff;border:1px solid #0ff;border-radius:4px;padding:4px}
.neon-border{border:2px solid #0ff;box-shadow:0 0 10px #0ff}
.priority-high{border-left:4px solid #0ff}
.priority-medium{border-left:4px solid #0f0}
.priority-low{border-left:4px solid #555}
</style>
</head>
<body class="bg-black text-white min-h-screen flex flex-col items-center">
<div id="loginSection" class="w-full max-w-sm p-4 mt-8 neon-border rounded-lg">
<h1 class="text-2xl mb-4 text-center text-cyan-400 font-bold">Login</h1>
<input id="usernameInput" type="text" placeholder="Digite seu usuário" class="w-full p-2 mb-4 bg-black border border-cyan-400 rounded">
<button id="loginBtn" class="w-full bg-cyan-500 text-black font-semibold py-2 rounded hover:bg-cyan-400">Entrar</button>
</div>

<div id="appSection" class="hidden w-full max-w-2xl p-4">
<header class="flex justify-between items-center mb-4">
<h1 class="text-3xl font-bold text-cyan-400">To-Do List Neon</h1>
<div class="flex gap-2">
<button id="toggleDarkMode" class="px-3 py-1 rounded bg-cyan-500 text-black hover:bg-cyan-400">Dark Mode</button>
<button id="logoutBtn" class="px-3 py-1 rounded bg-red-500 text-black hover:bg-red-400">Sair</button>
</div>
</header>

<form id="taskForm" class="flex flex-col gap-3 mb-6 p-4 rounded-lg neon-border">
<input id="taskInput" type="text" placeholder="Nova tarefa" class="p-2 rounded bg-black border border-cyan-400">
<select id="priorityInput" class="p-2 rounded bg-black border border-cyan-400">
<option value="low">Baixa</option>
<option value="medium">Média</option>
<option value="high">Alta</option>
</select>
<div class="calendar">
<input id="dueDateInput" type="date">
</div>
<button class="bg-cyan-500 text-black font-semibold py-2 rounded hover:bg-cyan-400">Adicionar</button>
</form>

<div class="flex justify-between items-center mb-4">
<input id="searchInput" type="text" placeholder="Buscar tarefas" class="p-2 rounded bg-black border border-cyan-400 w-1/2">
<select id="filterSelect" class="p-2 rounded bg-black border border-cyan-400">
<option value="all">Todas</option>
<option value="pending">Pendentes</option>
<option value="completed">Concluídas</option>
</select>
</div>

<ul id="taskList" class="flex flex-col gap-3"></ul>
</div>

<script>
const loginSection=document.getElementById('loginSection')
const appSection=document.getElementById('appSection')
const usernameInput=document.getElementById('usernameInput')
const loginBtn=document.getElementById('loginBtn')
const logoutBtn=document.getElementById('logoutBtn')
const toggleDarkMode=document.getElementById('toggleDarkMode')
const taskForm=document.getElementById('taskForm')
const taskInput=document.getElementById('taskInput')
const priorityInput=document.getElementById('priorityInput')
const dueDateInput=document.getElementById('dueDateInput')
const taskList=document.getElementById('taskList')
const searchInput=document.getElementById('searchInput')
const filterSelect=document.getElementById('filterSelect')

let currentUser=null
let tasks=[]

function saveTasks(){localStorage.setItem(`tasks_${currentUser}`,JSON.stringify(tasks))}
function loadTasks(){tasks=JSON.parse(localStorage.getItem(`tasks_${currentUser}`)||'[]')}
function renderTasks(){
taskList.innerHTML=''
const search=searchInput.value.toLowerCase()
const filter=filterSelect.value
tasks.forEach((t,i)=>{
if(t.title.toLowerCase().includes(search)&&(filter==='all'||(filter==='pending'&&!t.completed)||(filter==='completed'&&t.completed))){
const li=document.createElement('li')
li.draggable=true
li.dataset.index=i
li.className=`task-card p-3 rounded bg-black neon-border ${t.priority==='high'?'priority-high':t.priority==='medium'?'priority-medium':'priority-low'}`
li.innerHTML=`
<div class="flex justify-between items-center">
<div>
<input type="checkbox" class="mr-2" ${t.completed?'checked':''}>
<span class="${t.completed?'line-through text-gray-500':''}">${t.title}</span>
${t.dueDate?`<small class="ml-2 text-cyan-400">[${t.dueDate}]</small>`:''}
</div>
<div class="flex gap-2">
<button class="add-subtask text-cyan-400">＋</button>
<button class="delete-task text-red-400">✕</button>
</div>
</div>
<ul class="subtasks mt-2 pl-6"></ul>
`
const subtasksUl=li.querySelector('.subtasks')
t.subtasks.forEach((s,si)=>{
const sLi=document.createElement('li')
sLi.innerHTML=`<input type="checkbox" class="mr-2" ${s.done?'checked':''}> <span class="${s.done?'line-through text-gray-500':''}">${s.text}</span>`
subtasksUl.appendChild(sLi)
sLi.querySelector('input').addEventListener('change',()=>{
s.done=!s.done
saveTasks()
renderTasks()
})
})
li.querySelector('input[type="checkbox"]').addEventListener('change',()=>{
t.completed=!t.completed
saveTasks()
renderTasks()
})
li.querySelector('.delete-task').addEventListener('click',()=>{
tasks.splice(i,1)
saveTasks()
renderTasks()
})
li.querySelector('.add-subtask').addEventListener('click',()=>{
const txt=prompt('Digite a subtarefa:')
if(txt){
t.subtasks.push({text:txt,done:false})
saveTasks()
renderTasks()
}
})
taskList.appendChild(li)
}
})
enableDragDrop()
}

function enableDragDrop(){
const items=document.querySelectorAll('#taskList .task-card')
items.forEach(it=>{
it.addEventListener('dragstart',()=>it.classList.add('dragging'))
it.addEventListener('dragend',()=>{it.classList.remove('dragging');reorderTasks()})
})
taskList.addEventListener('dragover',e=>{
e.preventDefault()
const dragging=document.querySelector('.dragging')
const siblings=[...taskList.querySelectorAll('.task-card:not(.dragging)')]
const next=siblings.find(s=>e.clientY<=s.offsetTop+s.offsetHeight/2)
taskList.insertBefore(dragging,next)
})
}

function reorderTasks(){
const newOrder=[...taskList.querySelectorAll('.task-card')].map(it=>tasks[it.dataset.index])
tasks=newOrder
saveTasks()
renderTasks()
}

taskForm.addEventListener('submit',e=>{
e.preventDefault()
const title=taskInput.value.trim()
if(title){
tasks.push({title,completed:false,priority:priorityInput.value,dueDate:dueDateInput.value,subtasks:[]})
saveTasks()
renderTasks()
taskForm.reset()
}
})

searchInput.addEventListener('input',renderTasks)
filterSelect.addEventListener('change',renderTasks)

toggleDarkMode.addEventListener('click',()=>document.body.classList.toggle('dark'))
loginBtn.addEventListener('click',()=>{
const u=usernameInput.value.trim()
if(u){
currentUser=u
loginSection.classList.add('hidden')
appSection.classList.remove('hidden')
loadTasks()
renderTasks()
}
})
logoutBtn.addEventListener('click',()=>{
currentUser=null
tasks=[]
appSection.classList.add('hidden')
loginSection.classList.remove('hidden')
})

function checkDueDates(){
const today=new Date().toISOString().split('T')[0]
tasks.forEach(t=>{
if(t.dueDate===today&&!t.completed){
new Notification('Tarefa pendente',{body:t.title})
}
})
}
if('Notification'in window&&Notification.permission!=='granted'){Notification.requestPermission()}
setInterval(checkDueDates,60000)
</script>
</body>
</html>
